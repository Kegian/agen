// Code generated by agen, DO NOT EDIT.

package server

import (
	"fmt"
	"net/http"

	"github.com/Kegian/agen"
	"go.uber.org/zap"
)

type Server struct {
	Addr string
	Mux  *http.ServeMux
}

func New(addr string, srv http.Handler) *Server {
	mux := http.NewServeMux()
	mux.Handle("/api/v1/", http.StripPrefix("/api/v1", agen.SentryMiddleware(srv)))
	mux.Handle("/swagger/", SwaggerHandler("/swagger"))
	mux.Handle("/ready", http.HandlerFunc(func(w http.ResponseWriter, _ *http.Request) {
		w.Write([]byte("OK"))
	}))
	return &Server{Addr: addr, Mux: mux}
}

func (s *Server) Run() error {
	zap.L().Info(fmt.Sprintf("start listenning on %s ...", s.Addr))
	return http.ListenAndServe(s.Addr, s.Mux)
}
